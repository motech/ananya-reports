<?xml version="1.0" encoding="UTF-8"?>
<project name="ananya-kilkari-report" xmlns:flyway="antlib:com.googlecode.flyway.ant">

    <target name="clean.existing.database">
        <echo message="Cleaning all databases"/>
        <path id="dependencies">
            <fileset file="${basedir}/build/postgresql-9.1-901.jdbc4.jar"/>
        </path>
        <flyway:clean driver="org.postgresql.Driver"
                      url="jdbc:postgresql://localhost/ananya/"
                      user="postgres"
                      password="password"
                      schemas="report"
                      classpathref="dependencies"/>
    </target>

    <target name="initialize.and.migrate.db">
        <sequential>
            <echo message="Initializing report database"/>
            <path id="dependencies">
                <fileset file="${basedir}/build/postgresql-9.1-901.jdbc4.jar"/>
            </path>
            <flyway:init driver="org.postgresql.Driver"
                         url="jdbc:postgresql://localhost/ananya/"
                         user="postgres"
                         password="password"
                         schemas="report"
                         classpathref="dependencies"/>

            <echo message="Applying database migrations"/>


            <flyway:migrate driver="org.postgresql.Driver"
                            url="jdbc:postgresql://localhost/ananya/"
                            user="postgres"
                            password="password"
                            schemas="report"
                            classpathref="dependencies"/>
        </sequential>
    </target>
</project>